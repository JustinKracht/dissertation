# Supplemental Tables and Figures {#appendix-b}

Here is where we can put extra material that is useful, but perhaps not critical to the overall paper. This could include instruments, consent forms, additional syntax, proofs, supplemental graphics, etc.

## Tables Corresponding to Figures

## Expanded Figures

### Percent of CB Solutions that were Indefinite

```{r fig-percent-indefinite-matrices-expanded, fig.cap = "The percent of Cudeck-Browne (CB) method solutions that were indefinite, conditioned on number of factors, factor loading, number of items per factor, factor correlation, and model fit.", out.width='90%'}
if (make_plots) {
  cb_percent_indefinite <- results_matrix %>%
    filter(error_method == "CB") %>%
    mutate(error= case_when(is.na(error) ~ " ",
                            TRUE ~ error),
           items_per_factor = as.factor(items_per_factor),
           factors = as.factor(factors),
           model_fit = factor(model_fit,
                              levels = c("Very Good", "Fair", "Poor"),
                              labels = c("Fit: Very Good", 
                                         "Fit: Fair", 
                                         "Fit: Poor"))) %>%
    group_by(factors, items_per_factor_rec, 
             loading_numeric, model_fit, factor_cor_rec) %>%
    summarise(mean_indefinite = mean(
      str_detect(error, "indefinite")
    )) %>%
    ungroup() %>%
    ggplot(aes(y = mean_indefinite, x = loading_numeric,
               color = factors,
               shape = factors, 
               linetype = factors,
               group = factors)) +
    geom_line() + 
    geom_point() +
    scale_color_viridis_d(end = .85) +
    scale_y_continuous(labels = scales::percent, limits = c(0, 1)) +
    scale_x_continuous(breaks = c(.4, .6, .8)) +
    facet_grid(items_per_factor_rec * factor_cor_rec ~ model_fit) +
    theme_bw() +
    labs(color = "Factors",
         fill = "Factors",
         linetype = "Factors",
         shape = "Factors",
         y = "Indefinite Solutions",
         x = "Factor Loading") +
    theme(legend.position = "bottom")
  
  ggsave(filename = here("img/cb_percent_indefinite_full.png"),
         plot = cb_percent_indefinite,
         dpi = "retina",
         width = 6,
         height = 8)
}

knitr::include_graphics(here("img/cb_percent_indefinite_full.png"))
```

### Percent of TKL Solutions Where the Constraints on $\mathbf{W}$ were Violated

```{r w-major-factors-plot-expanded, fig.cap = "The percent of cases where the constraints on $\\mathbf{W}$ were violated when the $\\textrm{TKL}_{\\textrm{RMSEA}}$ model-error method was used, conditioned on number of factors, number of items per factor, factor loading, factor correlation, and model fit.", out.width='85%'}
if (make_plots) {
  percent_w_major_factors_table <- results_matrix %>%
    filter(!(error_method %in% c("CB", "WB"))) %>%
    group_by(factors, items_per_factor_rec, loading_numeric, 
             model_fit_rec, error_method_rec, factor_cor_rec, error_method) %>%
    mutate(w_has_major_factors = fn_value >= 1e06) %>%
    summarise(mean_w_major_factors =
                mean(w_has_major_factors, na.rm = TRUE))
  
  w_major_factors_plot <- percent_w_major_factors_table %>%
    filter(error_method == "TKL (RMSEA)") %>%
    mutate(factors = as.factor(factors)) %>%
    ggplot(aes(y = mean_w_major_factors, 
               x = loading_numeric, 
               color = factors, 
               linetype = factors, 
               shape = factors, 
               group = factors)) +
    geom_line() +
    geom_point() +
    scale_color_viridis_d(end = .85) +
    scale_y_continuous(label = scales::percent_format(accuracy = 1)) +
    scale_x_continuous(breaks = c(.4, .6, .8)) +
    facet_grid(items_per_factor_rec * factor_cor_rec ~ model_fit_rec) +
    theme_bw() +
    labs(x = "Loadings", y = TeX("Cases with Violtated $W$ Constraints"), 
         color = "Factors", linetype = "Factors", shape = "Factors") +
    theme(legend.position = "bottom")
  
  ggsave(filename = here("img/major_minor_factors_full.png"),
         w_major_factors_plot,
         dpi = 320,
         width = 6, 
         height = 8)
}

knitr::include_graphics(here("img/major_minor_factors_full.png"))
```

### Observed RMSEA Values

```{r rmsea-distributions-full, fig.cap = "Distributions of the RMSEA values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the target RMSEA value for each condition. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne.", out.width='70%'}
if (make_plots) {
  rmsea_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = rmsea)) +
    geom_hline(aes(yintercept = target_rmsea), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = "RMSEA") +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/rmsea_distributions_full.png"), 
    plot = rmsea_distributions,
    dpi = 320,
    height = 8, width = 5.25,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/rmsea_distributions_full.png"))
```

### Observed CFI Values

```{r cfi-distributions-full, fig.cap = "Distributions of the CFI values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the target CFI value for each condition. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne.", out.width='70%'}
if (make_plots) {
  cfi_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = cfi)) +
    geom_hline(aes(yintercept = target_cfi), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = "CFI") +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/cfi_distributions_full.png"), 
    plot = cfi_distributions,
    dpi = 320,
    height = 8, width = 5.25,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/cfi_distributions_full.png"))
```
### Observed TLI Values

```{r tli-distributions-full, out.width="70%"}
#| fig.cap="Distributions of the TLI values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the threshold values of TLI that correspond to the targeted levels of model fit, according to Hu and Bentler (1999). TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne."

if (make_plots) {
  tli_distributions <- 
    results_matrix %>%
    mutate(tli = case_when(tli < 0 ~ 0, TRUE ~ tli)) %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = tli)) +
    geom_hline(aes(yintercept = target_cfi), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = "TLI") +
    theme_bw() +
    theme(panel.spacing.x = unit(10, units = "pt"),
          plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/tli_distributions_full.png"), 
    plot = tli_distributions,
    dpi = 320,
    height = 8, width = 5.25,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/tli_distributions_full.png"))
```

### Observed CRMR Values

```{r crmr-distributions-full, fig.cap="Distributions of the CRMR values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. Recommendations for threshold values of SRMR/CRMR are not as fine-grained as for some other fit indices, but threshold values of 0.05 and 0.08 were proposed by Hu and Bentler (1999) as more and less conservative upper-bounds for acceptable SRMR/CRMR values. The dashed lines indicate these two threshold values. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne.", out.width="70%"}
if (make_plots) {
  crmr_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = crmr)) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    geom_hline(yintercept = 0.05, 
               color = "black", linetype = "dashed", size = .25) +
    geom_hline(yintercept = 0.08, 
               color = "black", linetype = "dashed", size = .25) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = "CRMR") +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/crmr_distributions_full.png"), 
    plot = crmr_distributions,
    dpi = 320,
    height = 8, width = 5.25,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/crmr_distributions_full.png"))
```

## Fit Indices Based on $\hat{\Sigma}$

### $\textrm{RMSEA}_{\hat{\theta}}$

```{r rmsea-thetahat-distributions, out.width="85%"}
#| fig.cap = "Distributions of the $\\textrm{RMSEA}_{\\hat{\\theta}}$ values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the target RMSEA value for each condition. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne."
if (make_plots) {
  rmsea_thetahat_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = rmsea_thetahat)) +
    geom_hline(aes(yintercept = target_rmsea), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = latex2exp::TeX("$RMSEA_{\\hat{\\theta}}$")) +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/rmsea_thetahat_distributions.png"), 
    plot = rmsea_thetahat_distributions,
    dpi = 320,
    height = 7.5, width = 6.5,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/rmsea_thetahat_distributions.png"))
```

### $\textrm{CFI}_{\hat{\theta}}$

```{r cfi-thetahat-distributions, out.width="90%"}
#| fig.cap = "Distributions of the $\\textrm{CFI}_{\\hat{\\theta}}$ values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the target CFI value for each condition. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne."
if (make_plots) {
  cfi_thetahat_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = cfi_thetahat)) +
    geom_hline(aes(yintercept = target_cfi), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = latex2exp::TeX("$CFI_{\\hat{\\theta}}$")) +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/cfi_thetahat_distributions.png"), 
    plot = cfi_thetahat_distributions,
    dpi = 320,
    height = 7.5, width = 6.5,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/cfi_thetahat_distributions.png"))
```

### $\textrm{TLI}_{\hat{\theta}}$

```{r tli-thetahat-distributions, out.width="90%"}
#| fig.cap = "Distributions of the $\\textrm{TLI}_{\\hat{\\theta}}$ values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. The dashed lines indicate the threshold values of TLI that correspond to the targeted levels of model fit, according to Hu and Bentler (1999). TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne."
if (make_plots) {
  tli_thetahat_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = tli_thetahat)) +
    geom_hline(aes(yintercept = target_cfi), 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = latex2exp::TeX("$TLI_{\\hat{\\theta}}$")) +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/tli_thetahat_distributions.png"), 
    plot = tli_thetahat_distributions,
    dpi = 320,
    height = 7.5, width = 6.5,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/tli_thetahat_distributions.png"))
```

### $\textrm{CRMR}_{\hat{\theta}}$

```{r crmr-thetahat-distributions, out.width="90%"}
#| fig.cap = "Distributions of the $\\textrm{TLI}_{\\hat{\\theta}}$ values for solutions produced by each of the model-error methods, conditioned on number of factors, model fit, and factor loading strength. Recommendations for threshold values of SRMR/CRMR are not as fine-grained as for some other fit indices, but threshold values of 0.05 and 0.08 were proposed by Hu and Bentler (1999) as more and less conservative upper-bounds for acceptable SRMR/CRMR values. The dashed lines indicate these two threshold values. TKL = Tucker, Koopman, and Linn; CB = Cudeck and Browne; WB = Wu and Browne."
if (make_plots) {
  crmr_thetahat_distributions <- 
    results_matrix %>%
    filter(rmsea < 3) %>%
    ggplot(aes(x = fct_rev(error_method_rec), y = crmr_thetahat)) +
    geom_hline(yintercept = 0.05, 
               color = "black", linetype = "dashed", size = .25) +
    geom_hline(yintercept = 0.08, 
               color = "black", linetype = "dashed", size = .25) +
    geom_boxplot(outlier.size = .5, outlier.stroke = .25, lwd = .5,
                 fatten = 1.5) +
    coord_flip() +
    scale_x_discrete(labels = parse(text=levels(results_matrix$error_method_rec)[5:1])) +
    facet_grid(model_fit_rec * loading_rec ~ 
                 factors_rec) +
    labs(x = "",
         y = latex2exp::TeX("$CRMR_{\\hat{\\theta}}$")) +
    theme_bw() +
    theme(plot.margin = margin(0, 0, 0, -14, unit = "pt"))
  
  ggsave(
    filename = here("img/crmr_thetahat_distributions.png"), 
    plot = crmr_thetahat_distributions,
    dpi = 320,
    height = 7.5, width = 6.5,
    scale = 1.4
  )
}

knitr::include_graphics(here("img/crmr_thetahat_distributions.png"))
```